Подготовка навигатора Garmin для загрузки растровых карт
========================================================

В навигаторы Garmin можно загружать растровые карты в двуг форматах: JNX и KMZ.
Сайт nakarte позволяет делать только файлы JNX.

Формат JNX преднаначался  компанией Garmin для распространения  космоснимков через платную подписку BirdsEye.
Чтобы прибор показывал любые самодельные файлы, в т.ч. созданные в nakarte, надо сделать одно из двух:

1. Из `описания фомата JNX <http://whiter.brinkster.net/JNX.shtml>`_:

    Если у вас оформлена подписка BirdsEye, можно воспользоваться BaseCamp для активации собственных карт JNX.
    Для этого достаточно сделать карту одним из конвертеров [например, nakarte],
    загрузить полученный файл JNX в устройство [в каталог :file:`X:\\Garmin\\BirdsEye`],
    затем запустить BaseCamp и скопировать карту с устройства в :guilabel:`Коллекцию`.
    После этого карту можно будет послать обратно на устройство,
    при этом BaseCamp активирует карту и привяжет её к устройству.
    Этот метод сработает только в том случае, если устройство связано с подпиской BirdsEye.

2. Нужно модифицировать прошивку прибора,
   тогда можно будет просто загружать файлы в прибор в каталог :file:`X:\\Garmin\\BirdsEye`.

Второй вариант опишем подробно.

1. Смотрим версию прошивки в приборе: нажимаем :kbd:`MENU MENU`, выбираем :menuselection:`Настройки --> О Системе`

   * Если в первой строке написано :guilabel:`Patched Version`,
     то прошивка уже модифицирована и дальше ничего делать не надо (если не собираетесь обновлять её).
   * Если написано просто :guilabel:`Version`, запоминаем версию

2. Проверяем, что модель нашего прибора есть
   `в  списке поддерживаемых устройств <http://whiter.brinkster.net/Versions.shtml>`_.
3. Скачиваем последнюю версию прошивки для своей модели прибора.

   1. Ищем страницу обновления прибора:
      в google ищем "site:www8.garmin.com webupdater <модель навигатора>".
      Если найдено больше одной страницы, нужна та, на которой есть раздел "Change History".
   2. Нажимаем :kbd:`Ctl-U` -  появляется исходный код страницы.
   3. В самом верху находим инструкцию из трёх пунктов.
      В первом пункте находится ссылка на файл прошивки.
   4. В ссылке, в имени файла есть версия прошивки.
      Она должна быть больше или равной версии из п.1.
      Если это не так, то это не та модель прибора, не надо использовать эту прошивку.
   5.  Копируем ссылку и скачиваем по ней файл.
4. Скачиваем `патчер <http://whiter.brinkster.net/FirmwarePatcher.html>`_
5. Патчим прошивку:

   * Запускаем патчер
   * Если в приборе установлена последняя версия прошивки, т.е. версия из п.1 и из п.3 совпадают,
     то прибор откажется устанавливать изменённую прошивку.
     Чтобы это обойти, включаем галочку :guilabel:`Adjust firmware version number by` и ставим :guilabel:`1`
   * Нажимаем :guilabel:`Browse`, указываем скачанный в п.3 файл с расширением .gcd
   * Убеждаемся, что появилась надпись :guilabel:`File patched successfully`

6. Проверяем, что заряд батареек в приборе больше 50%
7. Подключаем прибор к компьютеру
8. Копируем полученный в п.5 файл (его имя зканчивается на :file:`_Patched.gcd`)
   в прибор в каталог :file:`X:\\Garmin`
   и переименовываем его там в :file:`GUPDATE.gcd`.
9. Нажимаем :guilabel:`безопасное извлечение USB-устройства` и отключаем прибор от компьютера.
10. Включаем прибор, дожидаемся окончания установки новой прошивки
11. Смотрим версию как в п.1, убеждаемся, что установилась модифицированная прошивка.

